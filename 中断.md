中断：（hardirq）

中断是系统用来响应硬件设备请求的一种机制，操作系统收到硬件的中断请求，会打断正在执行的进程，然后调用内核中的中断处理程序来响应请求。

操作系统收到了中断请求，会打断其他进程的运行，所以中断请求的响应程序，也就是中断处理程序，要尽可能快的执行完，这样可以减少对正常进程运行调度地影响。

中断处理程序在响应中断时，可能还会「临时关闭中断」，这意味着，如果当前中断处理程序没有执行完之前，系统中其他的中断请求都无法被响应，也就说中断有可能会丢失，所以中断处理程序要短且快。（相当于在跟别人打电话的时候，第三个人来电话，无法接受到）


软中断：（softirq）

为了解决中断执行时间过长和中断丢失问题，中断过程分成了两个阶段，上部分和下部分。

1）上半部用来快速处理中断，一般会暂时关闭中断请求，主要负责处理跟硬件紧密相关或者时间敏感的事情。（直接处理硬件请求，硬中断，响应请求，耗时短速度快。）
2）下部分用来延迟处理上部分未完成的工作，处理中断请求，一般以内核线程的方式运行。（软中断，由内核触发，耗时长，延迟执行），每一个 CPU 都对应一个软中断内核线程，名字通常为「ksoftirqd/CPU 编号。

软中断不只是包括硬件设备中断处理程序的下半部，一些内核自定义事件也属于软中断，比如内核调度等、网络收发、RCU 锁（内核里常用的一种锁）等。


查看系统中的软硬终端：

/proc/softirqs 软中断
/proc/interrupts 硬中断

如果要实时查看中断次数的变化率，可以使用 watch -d cat /proc/softirqs 命令

每一个 CPU 都有各自的软中断内核线程，我们还可以用 ps 命令来查看内核线程，一般名字在中括号里面到，都认为是内核线程。

如果在 top 命令发现，CPU 在软中断上的使用率比较高，而且 CPU 使用率最高的进程也是软中断 ksoftirqd 的时候，这种一般可以认为系统的开销被软中断占据了。
